{"remainingRequest":"D:\\DTC PROJECT\\booking\\web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!D:\\DTC PROJECT\\booking\\web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\DTC PROJECT\\booking\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DTC PROJECT\\booking\\web\\src\\views\\user.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DTC PROJECT\\booking\\web\\src\\views\\user.vue","mtime":1570009591765},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DTC PROJECT\\booking\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Datepicker from 'vuejs-datepicker';\nimport service from '@/service/service';\nimport EditUser from './extra-components/edit-user.vue'; // import ViewData from './view/ViewData.vue';\n\nimport moment from 'moment'; // import firebase from 'firebase/app'ว\n// import * as firebase from 'firebase/app';\n// import '@firebase/messaging';\n\nexport default {\n  components: {\n    EditUser: EditUser,\n    Datepicker: Datepicker\n  },\n  data: function data() {\n    return {\n      change_password: false,\n      renderComponent: true,\n      sideBarActive: false,\n      popupActive: false,\n      users: [],\n      roles: [],\n      submitted: false,\n      editObj: {}\n    };\n  },\n  computed: {\n    invalid: function invalid() {\n      var _this = this;\n\n      var require = function require(type) {\n        return _this.submitted && _this.editObj[type] == '';\n      };\n\n      return {\n        first_name: require('first_name'),\n        last_name: require(\"last_name\"),\n        email: require(\"email\"),\n        username: require(\"username\"),\n        password: (!this.popupActive || this.change_password) && require(\"password\"),\n        confirm_password: this.submitted && this.editObj.password != this.editObj.confirm_password,\n        role: require(\"role\"),\n        old_password: this.change_password && require(\"old_password\")\n      };\n    },\n    isInvald: function isInvald() {\n      return this.invalid.first_name || this.invalid.last_name || this.invalid.email || this.invalid.username || this.invalid.password || this.invalid.confirm_password || this.invalid.role || this.old_password;\n    }\n  },\n  created: function created() {\n    this.getdata();\n    this.initVal();\n  },\n  methods: {\n    initVal: function initVal() {\n      this.submitted = false;\n      this.change_password = false, this.popupActive = false;\n      this.editObj = {\n        old_password: \"\",\n        first_name: \"\",\n        last_name: \"\",\n        email: \"\",\n        username: \"\",\n        password: \"\",\n        confirm_password: \"\",\n        role: \"\"\n      };\n    },\n    edit: function edit() {\n      var _this2 = this;\n\n      this.submitted = true;\n\n      if (!this.isInvald) {\n        var url;\n\n        if (this.change_password) {\n          url = \"admin_change_password\";\n        } else {\n          url = \"update_user\";\n        }\n\n        this.popupActive = false;\n        service.postData(url, this.editObj).then(function (result) {\n          _this2.$swal(_this2.$t(\"success_title\"), \"\", \"success\").then(function (result) {\n            _this2.getdata();\n\n            _this2.forceRerender();\n\n            _this2.initVal();\n          });\n        });\n      }\n    },\n    delete_user: function delete_user(user) {\n      var _this3 = this;\n\n      this.$swal({\n        title: this.$t('delete_user_title'),\n        text: this.$t('delete_text'),\n        type: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#d33',\n        cancelButtonText: this.$t('cancel'),\n        confirmButtonText: this.$t('confirm_delete'),\n        showLoaderOnConfirm: true,\n        preConfirm: function preConfirm() {\n          return service.postData(\"/delete_user\", {\n            username: user.username\n          }).then(function (result) {\n            return result;\n          });\n        }\n      }).then(function (result) {\n        if (result.value) {\n          if (result.value.code) {\n            _this3.$swal(_this3.$t(\"deleted_title\"), \"\", \"success\").then(function (result) {\n              _this3.getdata();\n\n              _this3.forceRerender();\n\n              _this3.initVal();\n            });\n          } else {\n            _this3.$swal(result.value.message, '', 'error');\n          }\n        }\n      });\n    },\n    getdata: function getdata() {\n      var _this4 = this;\n\n      service.postData(\"/get_user\", {}).then(function (result) {\n        _this4.users = result.data.map(function (item) {\n          item.password = \"\";\n          item.confirm_password = \"\";\n          return item;\n        });\n      });\n      service.postData(\"/get_role\", {}).then(function (result) {\n        _this4.roles = result.data;\n      }, function (err) {});\n    },\n    forceRerender: function forceRerender() {\n      var _this5 = this;\n\n      this.renderComponent = false;\n      this.$nextTick(function () {\n        _this5.renderComponent = true;\n      });\n    },\n    save: function save() {\n      var _this6 = this;\n\n      this.submitted = true;\n\n      if (!this.isInvald) {\n        service.postData(\"/add_user\", this.editObj).then(function (result) {\n          _this6.$swal(_this6.$t(\"success_title\"), \"\", \"success\").then(function (result) {\n            _this6.getdata();\n\n            _this6.forceRerender();\n\n            _this6.initVal();\n          });\n        });\n      }\n    }\n  },\n  watch: {\n    popupActive: function popupActive(val) {\n      if (!val) {\n        this.initVal();\n      }\n    }\n  }\n};",{"version":3,"sources":["user.vue"],"names":[],"mappings":"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","sourcesContent":["<template >\r\n  <div class=\"vx-col w-full mb-base\" v-if=\"renderComponent\">\r\n\r\n    <!-- <edit-user :isSidebarActive=\"sideBarActive\" :operator=\"edit_operator\" @closeSidebar=\"sideBarActive = false\" /> -->\r\n\r\n    <vx-card>\r\n        <!-- <pre>{{x}}</pre> -->\r\n        <vs-tabs >\r\n            <vs-tab :label=\"$t('user_data')\">\r\n               <div class=\"mt-3\">\r\n                 <vs-table pagination max-items=\"10\" search :data=\"users\">\r\n\r\n                    <template slot=\"thead\">\r\n                      <vs-th sort-key=\"index\">{{$t('username')}}</vs-th>\r\n                      <vs-th sort-key=\"first_name\">{{$t('first_name')}}</vs-th>\r\n                      <vs-th sort-key=\"last_name\">{{$t('last_name')}}</vs-th>\r\n                      <vs-th sort-key=\"email\">{{$t('email')}}</vs-th>\r\n                      <vs-th sort-key=\"role_name\">{{$t('role')}}</vs-th>\r\n\r\n                      <vs-th>{{$t(\"edit\")}}</vs-th>\r\n                      <vs-th>{{$t(\"delete\")}}</vs-th>\r\n                    </template>\r\n\r\n                    <template slot-scope=\"{data}\">\r\n                      <vs-tr :data=\"tr\" :key=\"index\" v-for=\"(tr, index) in data\">\r\n\r\n                        <vs-td :data=\"tr.username\">\r\n                          {{tr.username}}\r\n                        </vs-td>\r\n\r\n                        <vs-td :data=\"tr.first_name\">\r\n                          {{ tr.first_name}}\r\n                        </vs-td>\r\n                        <vs-td :data=\"tr.last_name\">{{tr.last_name}}</vs-td>\r\n                        <vs-td :data=\"tr.last_name\">\r\n                          {{ tr.email }}\r\n                        </vs-td>\r\n\r\n                        <vs-td :data=\"tr.role_name\">\r\n                          {{ $t(tr.role_name) }}\r\n                        </vs-td>\r\n\r\n                        <vs-td>\r\n                          <feather-icon icon=\"EditIcon\" class=\"cursor-pointer w-6 h-6 text-warning\" size=\"small\" @click=\"editObj=tr;popupActive=true\"></feather-icon>\r\n                        </vs-td>\r\n                        <vs-td>\r\n                          <feather-icon icon=\"Trash2Icon\" class=\"cursor-pointer w-6 h-6 text-danger\" size=\"small\" @click=\"delete_user(tr)\"></feather-icon>\r\n                        </vs-td>\r\n                      </vs-tr>\r\n                    </template>\r\n                  </vs-table>\r\n               </div>\r\n            </vs-tab>\r\n            <vs-tab :label=\"$t('add_user')\">\r\n              <div class=\"vx-row\">\r\n                <div class=\"vx-col md:w-1/3 mt-5\">\r\n                    <label>{{$t('first_name')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.first_name\" class=\"w-full\" :danger=\"invalid.first_name\" />\r\n                    <div class=\"errors\" v-if=\"invalid.first_name\">\r\n                      {{$t(\"alert_first_name\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-1/3 mt-5\">\r\n                    <label>{{$t('last_name')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.last_name\" class=\"w-full\" :danger=\"invalid.last_name\" />\r\n                    <div class=\"errors\" v-if=\"invalid.last_name\">\r\n                      {{$t(\"alert_last_name\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-1/3 mt-5\">\r\n                    <label>{{$t('email')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.email\" class=\"w-full\" :danger=\"invalid.email\" />\r\n                    <div class=\"errors\" v-if=\"invalid.email\">\r\n                      {{$t(\"alert_email\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-1/2 mt-5\">\r\n                    <label>{{$t('username')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.username\" class=\"w-full\" :danger=\"invalid.username\" />\r\n                    <div class=\"errors\" v-if=\"invalid.username\">\r\n                      {{$t(\"alert_username\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-1/2 mt-5\">\r\n                    <label>{{$t('password')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.password\" class=\"w-full\" :danger=\"invalid.password\" />\r\n                    <div class=\"errors\" v-if=\"invalid.password\">\r\n                      {{$t(\"alert_password\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-1/2 mt-5\">\r\n                    <label>{{$t('confirm_password')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.confirm_password\" class=\"w-full\" :danger=\"invalid.confirm_password\" />\r\n                    <div class=\"errors\" v-if=\"invalid.confirm_password\">\r\n                      {{$t(\"alert_confirm_password\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-1/2 mt-5\">\r\n                    <label>{{$t('role')}}<span class=\"require\">*</span></label>\r\n                   <vs-select class=\"w-full\" v-model=\"editObj.role\" :danger=\"invalid.role\">\r\n                          <vs-select-item :key=\"index\" :value=\"item.role_id\" :text=\"$t(item.role_name)\" v-for=\"(item,index) in roles\" />\r\n                    </vs-select>\r\n                    <div class=\"errors\" v-if=\"invalid.role\">\r\n                      {{$t(\"alert_role\")}}\r\n                    </div>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <div class=\"vx-row\">\r\n                    <div class=\"vx-col w-full mt-5\">\r\n\r\n                       <vs-button color=\"danger\" class=\"right\" type=\"border\" @click=\"forceRerender()\">{{$t('cancel')}}</vs-button>\r\n                      <vs-button ref=\"loadableButton\" id=\"button-with-loading\" class=\"vs-con-loading__container right\" vslor=\"primary\" @click=\"save\">{{$t('save')}}</vs-button>\r\n                    </div>\r\n                </div>\r\n              </div>\r\n            </vs-tab>\r\n\r\n        </vs-tabs>\r\n         <vs-popup class=\"holamundo\"  :title=\"$t('edit_title')\" :active.sync=\"popupActive\">\r\n                 <v-template v-if=\"!change_password\">\r\n                   <div class=\"vx-col md:w-full mt-3\">\r\n                    <label>{{$t('first_name')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.first_name\" class=\"w-full\" :danger=\"invalid.first_name\" />\r\n                    <div class=\"errors\" v-if=\"invalid.first_name\">\r\n                      {{$t(\"alert_first_name\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-full mt-3\">\r\n                    <label>{{$t('last_name')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.last_name\" class=\"w-full\" :danger=\"invalid.last_name\" />\r\n                    <div class=\"errors\" v-if=\"invalid.last_name\">\r\n                      {{$t(\"alert_last_name\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-full mt-3\">\r\n                    <label>{{$t('email')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.email\" class=\"w-full\" :danger=\"invalid.email\" />\r\n                    <div class=\"errors\" v-if=\"invalid.email\">\r\n                      {{$t(\"alert_email\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-full mt-3\">\r\n                    <label>{{$t('username')}}<span class=\"require\">*</span></label>\r\n                    <vs-input v-model=\"editObj.username\" class=\"w-full\" :danger=\"invalid.username\" disabled/>\r\n                    <div class=\"errors\" v-if=\"invalid.username\">\r\n                      {{$t(\"alert_username\")}}\r\n                    </div>\r\n                </div>\r\n                <div class=\"vx-col md:w-full mt-3\">\r\n                    <label>{{$t('role')}}<span class=\"require\">*</span></label>\r\n                    <vs-select class=\"w-full\" v-model=\"editObj.role\" :danger=\"invalid.role\">\r\n                          <vs-select-item :key=\"index\" :value=\"item.role_id\" :text=\"$t(item.role_name)\" v-for=\"(item,index) in roles\" />\r\n                    </vs-select>\r\n                    <div class=\"errors\" v-if=\"invalid.role\">\r\n                      {{$t(\"alert_role\")}}\r\n                    </div>\r\n                </div>\r\n\r\n                 </v-template>\r\n                 <v-template v-if=\"change_password\">\r\n\r\n                    <div class=\"vx-col md:w-full mt-3\">\r\n                        <label>{{$t('new_password')}}<span class=\"require\">*</span></label>\r\n                        <vs-input v-model=\"editObj.password\" class=\"w-full\" :danger=\"invalid.password\" />\r\n                        <div class=\"errors\" v-if=\"invalid.password\">\r\n                          {{$t(\"alert_password\")}}\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"vx-col md:w-full mt-3\">\r\n                        <label>{{$t('confirm_password')}}<span class=\"require\">*</span></label>\r\n                        <vs-input v-model=\"editObj.confirm_password\" class=\"w-full\" :danger=\"invalid.confirm_password\"/>\r\n                        <div class=\"errors\" v-if=\"invalid.confirm_password\">\r\n                          {{$t(\"alert_confirm_password\")}}\r\n                        </div>\r\n                    </div>\r\n                 </v-template>\r\n                  <div class=\"vx-col md:w-full mt-5\">\r\n                      <vs-button color=\"primary\" @click=\"change_password=!change_password\">{{change_password?$t('edit_user'):$t('change_password')}}</vs-button>\r\n                      <vs-button class=\"right\" color=\"danger\" type=\"border\" @click=\"popupActive=false\">{{$t('cancel')}}</vs-button>\r\n                      <vs-button ref=\"loadableButton\" id=\"button-with-loading\" class=\"vs-con-loading__container right\" vslor=\"primary\" @click=\"edit()\">{{$t('save')}}</vs-button>\r\n                </div>\r\n          </vs-popup>\r\n    </vx-card>\r\n  </div>\r\n  <!-- <button>click</button> -->\r\n</template>\r\n<style lang=\"scss\" scoped>\r\n  .right{\r\n    float:right;\r\n    margin-right:10px;\r\n  }\r\n  .require{\r\n    color: red;\r\n  }\r\n\r\n  .danger input {\r\n    padding: .7rem;\r\n    font-size: 1rem;\r\n    border-radius: 5px;\r\n    border: 1px solid red;\r\n    color: #626262;\r\n    width: 100%;\r\n  }\r\n\r\n</style>\r\n\r\n\r\n<script>\r\nimport Datepicker from 'vuejs-datepicker';\r\nimport service from '@/service/service';\r\nimport EditUser from './extra-components/edit-user.vue';\r\n// import ViewData from './view/ViewData.vue';\r\nimport moment from 'moment';\r\n// import firebase from 'firebase/app'ว\r\n// import * as firebase from 'firebase/app';\r\n\r\n// import '@firebase/messaging';\r\nexport default {\r\n  components: {\r\n    EditUser,\r\n    Datepicker\r\n  },\r\n   data(){\r\n      return {\r\n        change_password:false,\r\n        renderComponent:true,\r\n        sideBarActive:false,\r\n        popupActive:false,\r\n        users:[],\r\n        roles:[],\r\n        submitted:false,\r\n        editObj:{}\r\n      }\r\n   },\r\n\r\n   computed:{\r\n     invalid(){\r\n       var require=type=>this.submitted&&this.editObj[type]=='';\r\n       return {\r\n         first_name:require('first_name'),\r\n         last_name:require(\"last_name\"),\r\n         email:require(\"email\"),\r\n         username:require(\"username\"),\r\n         password:(!this.popupActive||this.change_password)&&require(\"password\"),\r\n         confirm_password:this.submitted&&(this.editObj.password!=this.editObj.confirm_password),\r\n         role:require(\"role\"),\r\n         old_password:this.change_password&&require(\"old_password\")\r\n         }\r\n     },\r\n     isInvald(){\r\n       return this.invalid.first_name||this.invalid.last_name||this.invalid.email||this.invalid.username||this.invalid.password||this.invalid.confirm_password||this.invalid.role||this.old_password\r\n     }\r\n   },\r\n   created(){\r\n      this.getdata();\r\n      this.initVal();\r\n   },\r\n   methods: {\r\n     initVal(){\r\n       this.submitted=false;\r\n       this.change_password=false,\r\n       this.popupActive=false;\r\n       this.editObj={\r\n          old_password:\"\",\r\n          first_name:\"\",\r\n          last_name:\"\",\r\n          email:\"\",\r\n          username:\"\",\r\n          password:\"\",\r\n          confirm_password:\"\",\r\n          role:\"\"\r\n        }\r\n     },\r\n     edit(){\r\n       this.submitted=true;\r\n       if(!this.isInvald){\r\n        var url;\r\n        if(this.change_password){\r\n          url=\"admin_change_password\";\r\n        }else{\r\n          url=\"update_user\";\r\n        }\r\n        this.popupActive=false;\r\n        service.postData(url,this.editObj).then((result)=>{\r\n            this.$swal(this.$t(\"success_title\"),\"\",\"success\").then((result)=>{\r\n              this.getdata();\r\n              this.forceRerender();\r\n              this.initVal();\r\n           });\r\n          })\r\n       }\r\n     },\r\n     delete_user(user){\r\n       this.$swal({\r\n          title:this.$t('delete_user_title'),\r\n          text: this.$t('delete_text'),\r\n          type: 'warning',\r\n          showCancelButton: true,\r\n          confirmButtonColor: '#3085d6',\r\n          cancelButtonColor: '#d33',\r\n          cancelButtonText:this.$t('cancel'),\r\n          confirmButtonText:this.$t('confirm_delete'),\r\n          showLoaderOnConfirm: true,\r\n          preConfirm:()=>{\r\n            return  service.postData(\"/delete_user\",{username:user.username}).then((result)=>{\r\n               return result;\r\n            })\r\n\r\n          }\r\n        }).then((result) => {\r\n          if(result.value){\r\n            if(result.value.code){\r\n                this.$swal(this.$t(\"deleted_title\"),\"\",\"success\").then((result)=>{\r\n                    this.getdata();\r\n                    this.forceRerender();\r\n                    this.initVal();\r\n                });\r\n              }else{\r\n                 this.$swal(result.value.message,'','error')\r\n              }\r\n\r\n          }\r\n        })\r\n\r\n     },\r\n     getdata(){\r\n\r\n       service.postData(\"/get_user\",{\r\n\r\n      }).then((result)=>{\r\n        this.users=result.data.map((item)=>{\r\n          item.password=\"\";\r\n          item.confirm_password=\"\";\r\n          return item;\r\n          });\r\n      })\r\n        service.postData(\"/get_role\",{}).then((result)=>{\r\n          this.roles=result.data;\r\n        },err=>{\r\n\r\n        })\r\n     },\r\n     forceRerender(){\r\n       this.renderComponent=false;\r\n       this.$nextTick(() => {\r\n          this.renderComponent = true;\r\n        });\r\n     },\r\n     save(){\r\n       this.submitted=true;\r\n       if(!this.isInvald){\r\n         service.postData(\"/add_user\",this.editObj).then((result)=>{\r\n            this.$swal(this.$t(\"success_title\"),\"\",\"success\").then((result)=>{\r\n              this.getdata();\r\n              this.forceRerender();\r\n              this.initVal();\r\n           });\r\n         })\r\n       }\r\n     }\r\n    },\r\n  watch: {\r\n      popupActive(val){\r\n        if(!val){\r\n          this.initVal();\r\n        }\r\n      }\r\n    }\r\n}\r\n</script>\r\n\r\n"],"sourceRoot":"src/views"}]}